(function(){"use strict";var t={3244:function(t,e,r){var s=r(5130),o=r(6768);const a={id:"app"};function n(t,e,r,s,n,i){const d=(0,o.g2)("HW");return(0,o.uX)(),(0,o.CE)("div",a,[(0,o.bF)(d,{"duty-data":n.dutyData,"save-duty-entry":i.saveDutyEntry,"check-password":i.checkPassword},null,8,["duty-data","save-duty-entry","check-password"])])}r(8111),r(1701);var i=r(4232);const d={class:"calendar-container"},c={class:"fixed-header"},l={class:"header-top"},u={class:"month-title"},h={class:"header-bottom"},m={class:"weekdays"},y={class:"days"},p=["onClick"],f={key:0,class:"duty-name"},g={class:"nav-buttons-container"},v={key:0,class:"update-notification"},w={key:1,class:"modal-overlay"},k={class:"modal-content"},D={class:"modal-buttons"},b={key:0,class:"error-message"},E={key:2,class:"edit-form-container"},M={class:"form-grid"},L={class:"form-buttons"};function Y(t,e,r,a,n,Y){return(0,o.uX)(),(0,o.CE)("div",d,[(0,o.Lk)("div",c,[(0,o.Lk)("div",l,[(0,o.Lk)("h1",u,(0,i.v_)(Y.currentMonthTitle),1),(0,o.Lk)("div",h,[e[15]||(e[15]=(0,o.Lk)("label",{for:"startDay"},"시작 요일:",-1)),(0,o.bo)((0,o.Lk)("select",{id:"startDay","onUpdate:modelValue":e[0]||(e[0]=t=>n.startDayIndex=t)},[...e[14]||(e[14]=[(0,o.Lk)("option",{value:"0"},"일요일",-1),(0,o.Lk)("option",{value:"1"},"월요일",-1)])],512),[[s.u1,n.startDayIndex]])])])]),(0,o.Lk)("div",m,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Y.reorderedWeekdays,t=>((0,o.uX)(),(0,o.CE)("span",{key:t,class:(0,i.C4)({sunday:"일"===t,saturday:"토"===t})},(0,i.v_)(t),3))),128))]),(0,o.Lk)("div",y,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Y.daysInCurrentMonth,t=>((0,o.uX)(),(0,o.CE)("span",{key:t.key,class:(0,i.C4)({day:!0,padded:t.padded,today:t.isToday,"my-duty":Y.getDutyName(t.number)&&Y.getDutyName(t.number).isMe}),onClick:e=>Y.handleDayClick(t)},[(0,o.eW)((0,i.v_)(t.padded?"":t.number)+" ",1),Y.getDutyName(t.number)?((0,o.uX)(),(0,o.CE)("div",f,(0,i.v_)(Y.getDutyName(t.number).name),1)):(0,o.Q3)("",!0)],10,p))),128))]),e[25]||(e[25]=(0,o.Lk)("div",null,"22",-1)),(0,o.Lk)("div",g,[(0,o.Lk)("button",{onClick:e[1]||(e[1]=(...t)=>Y.prevMonth&&Y.prevMonth(...t)),class:"nav-button prev-button"},"‹"),(0,o.Lk)("button",{onClick:e[2]||(e[2]=(...t)=>Y.nextMonth&&Y.nextMonth(...t)),class:"nav-button next-button"},"›")]),n.updateExists?((0,o.uX)(),(0,o.CE)("div",v,[e[16]||(e[16]=(0,o.Lk)("p",null,"새로운 버전이 있습니다. 업데이트하시겠습니까?",-1)),(0,o.Lk)("button",{onClick:e[3]||(e[3]=(...t)=>Y.refreshApp&&Y.refreshApp(...t))},"업데이트")])):(0,o.Q3)("",!0),n.showPasswordModal?((0,o.uX)(),(0,o.CE)("div",w,[(0,o.Lk)("div",k,[e[17]||(e[17]=(0,o.Lk)("h3",null,"비밀번호 확인",-1)),e[18]||(e[18]=(0,o.Lk)("p",null,"당직 정보를 수정/입력하려면 비밀번호를 입력하세요.",-1)),(0,o.bo)((0,o.Lk)("input",{type:"password","onUpdate:modelValue":e[4]||(e[4]=t=>n.passwordInput=t),onKeyup:e[5]||(e[5]=(0,s.jR)((...t)=>Y.validatePassword&&Y.validatePassword(...t),["enter"])),placeholder:"비밀번호",autofocus:""},null,544),[[s.Jo,n.passwordInput]]),(0,o.Lk)("div",D,[(0,o.Lk)("button",{onClick:e[6]||(e[6]=(...t)=>Y.validatePassword&&Y.validatePassword(...t)),class:"modal-confirm"},"확인"),(0,o.Lk)("button",{onClick:e[7]||(e[7]=(...t)=>Y.cancelPassword&&Y.cancelPassword(...t)),class:"modal-cancel"},"취소")]),n.passwordMessage?((0,o.uX)(),(0,o.CE)("p",b,(0,i.v_)(n.passwordMessage),1)):(0,o.Q3)("",!0)])])):(0,o.Q3)("",!0),n.showEditForm?((0,o.uX)(),(0,o.CE)("div",E,[(0,o.Lk)("h2",null,(0,i.v_)(n.formDocId?"당직 정보 수정":"새 당직 정보 입력")+" ("+(0,i.v_)(n.currentEditingDate)+")",1),(0,o.Lk)("div",M,[e[21]||(e[21]=(0,o.Lk)("label",{for:"category"},"Category:",-1)),(0,o.bo)((0,o.Lk)("input",{id:"category",type:"text","onUpdate:modelValue":e[8]||(e[8]=t=>n.formEntry.category=t)},null,512),[[s.Jo,n.formEntry.category]]),e[22]||(e[22]=(0,o.Lk)("label",{for:"holidayYn"},"Holiday (Y/N):",-1)),(0,o.bo)((0,o.Lk)("select",{id:"holidayYn","onUpdate:modelValue":e[9]||(e[9]=t=>n.formEntry.holidayYn=t)},[...e[19]||(e[19]=[(0,o.Lk)("option",{value:"Y"},"Y",-1),(0,o.Lk)("option",{value:"N"},"N",-1)])],512),[[s.u1,n.formEntry.holidayYn]]),e[23]||(e[23]=(0,o.Lk)("label",{for:"meYn"},"Me (Y/N):",-1)),(0,o.bo)((0,o.Lk)("select",{id:"meYn","onUpdate:modelValue":e[10]||(e[10]=t=>n.formEntry.meYn=t)},[...e[20]||(e[20]=[(0,o.Lk)("option",{value:"Y"},"Y",-1),(0,o.Lk)("option",{value:"N"},"N",-1)])],512),[[s.u1,n.formEntry.meYn]]),e[24]||(e[24]=(0,o.Lk)("label",{for:"name"},"Name:",-1)),(0,o.bo)((0,o.Lk)("input",{id:"name",type:"text","onUpdate:modelValue":e[11]||(e[11]=t=>n.formEntry.name=t)},null,512),[[s.Jo,n.formEntry.name]]),(0,o.Lk)("div",L,[(0,o.Lk)("button",{onClick:e[12]||(e[12]=(...t)=>Y.saveDuty&&Y.saveDuty(...t)),class:"save-button"},"저장"),(0,o.Lk)("button",{onClick:e[13]||(e[13]=(...t)=>Y.closeForm&&Y.closeForm(...t)),class:"cancel-button"},"취소")])]),n.formMessage?((0,o.uX)(),(0,o.CE)("p",{key:0,class:(0,i.C4)({"error-message":n.formError,"success-message":!n.formError})},(0,i.v_)(n.formMessage),3)):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)])}r(4114),r(2489),r(116);var I={name:"HelloWorld",props:{dutyData:{type:Array,default:()=>[]},saveDutyEntry:{type:Function,required:!0},checkPassword:{type:Function,required:!0}},data(){return{weekdays:["일","월","화","수","목","금","토"],currentDate:new Date,startDayIndex:parseInt(localStorage.getItem("startDayIndex"))||0,updateExists:!1,registration:null,lastTaps:[],editingDay:null,currentEditingDate:"",formDocId:null,showPasswordModal:!1,passwordInput:"",passwordMessage:"",showEditForm:!1,formEntry:{category:"당직",date:"",holidayYn:"N",meYn:"N",name:""},formMessage:"",formError:!1}},computed:{currentMonthTitle(){const t=this.currentDate.getFullYear(),e=this.currentDate.getMonth();return`${t}년 ${e+1}월`},reorderedWeekdays(){const t=[...this.weekdays];for(let e=0;e<this.startDayIndex;e++)t.push(t.shift());return t},daysInCurrentMonth(){const t=this.currentDate.getFullYear(),e=this.currentDate.getMonth(),r=new Date,s=new Date(t,e,1).getDay(),o=new Date(t,e+1,0).getDate();let a=[];const n=(s-this.startDayIndex+7)%7;for(let i=0;i<n;i++)a.push({key:`pad-${i}`,padded:!0});for(let i=1;i<=o;i++){const s=new Date(t,e,i),o=s.toDateString()===r.toDateString();a.push({key:`day-${i}`,number:i,padded:!1,isToday:o})}return a}},watch:{startDayIndex(t){localStorage.setItem("startDayIndex",t)}},created(){document.addEventListener("swUpdated",this.showUpdatePrompt,{once:!0})},methods:{formatDateToYYMMDD(t){const e=this.currentDate.getFullYear().toString().substring(2),r=(this.currentDate.getMonth()+1).toString().padStart(2,"0"),s=t.toString().padStart(2,"0");return`${e}${r}${s}`},getDutyName(t){if(!t||!this.dutyData)return null;const e=this.formatDateToYYMMDD(t),r=this.dutyData.find(t=>t.date===e&&"당직"===t.category);return r?{name:r.name,isMe:"Y"===r.meYn,docId:r.id,fullEntry:r}:null},handleDayClick(t){if(t.padded)return;const e=Date.now(),r=this.formatDateToYYMMDD(t.number);this.lastTaps=this.lastTaps.filter(t=>e-t<500),this.lastTaps.push(e),3===this.lastTaps.length&&(this.editingDay=t.number,this.currentEditingDate=r,this.showPasswordModal=!0,this.passwordInput="",this.passwordMessage="",this.lastTaps=[])},async validatePassword(){this.passwordMessage="확인 중...";const t=await this.checkPassword(this.passwordInput);t.success?(this.passwordMessage="",this.showPasswordModal=!1,this.openEditForm()):this.passwordMessage=t.message||"비밀번호가 올바르지 않습니다."},cancelPassword(){this.showPasswordModal=!1,this.passwordInput="",this.passwordMessage=""},openEditForm(){const t=this.getDutyName(this.editingDay);if(this.formEntry.date=this.currentEditingDate,this.formMessage="",this.formError=!1,t&&t.fullEntry){const e=t.fullEntry;this.formDocId=e.id,this.formEntry.category=e.category,this.formEntry.holidayYn=e.holidayYn,this.formEntry.meYn=e.meYn,this.formEntry.name=e.name}else this.formDocId=null,this.formEntry.category="당직",this.formEntry.holidayYn="N",this.formEntry.meYn="N",this.formEntry.name="";this.showEditForm=!0},async saveDuty(){this.formMessage="저장 중...",this.formError=!1;const t=await this.saveDutyEntry(this.formEntry,this.formDocId);t?(this.formMessage=this.formDocId?"성공적으로 수정되었습니다.":"성공적으로 생성되었습니다.",setTimeout(this.closeForm,1500)):(this.formMessage="저장에 실패했습니다. 콘솔을 확인하세요.",this.formError=!0)},closeForm(){this.showEditForm=!1,this.editingDay=null,this.currentEditingDate="",this.formDocId=null,this.formMessage="",this.formError=!1,this.formEntry={category:"당직",date:"",holidayYn:"N",meYn:"N",name:""}},prevMonth(){this.currentDate=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth()-1,1),this.closeForm()},nextMonth(){this.currentDate=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth()+1,1),this.closeForm()},showUpdatePrompt(t){this.registration=t.detail,this.updateExists=!0},refreshApp(){this.updateExists=!1,this.registration&&this.registration.waiting&&this.registration.waiting.postMessage({type:"SKIP_WAITING"}),window.location.reload()}}},F=r(1241);const C=(0,F.A)(I,[["render",Y],["__scopeId","data-v-53cba712"]]);var N=C,x=r(6400),P=r(4703),T=r(2832),_={name:"App",components:{HW:N},data(){return{db:null,dutyData:[],unsubscribe:null}},methods:{async checkPassword(t){if(!this.db)return console.error("Firestore DB is not initialized."),{success:!1,message:"DB 초기화 오류."};try{const e=(0,T.P)((0,T.rJ)(this.db,"editpw"),(0,T._M)("password","==",t)),r=await(0,T.GG)(e);return r.empty?{success:!1,message:"비밀번호가 일치하지 않습니다."}:{success:!0}}catch(e){return console.error("비밀번호 확인 중 오류 발생:",e),{success:!1,message:`비밀번호 확인 중 오류 발생: ${e.message}`}}},async saveDutyEntry(t,e){if(!this.db)return console.error("Firestore DB is not initialized."),!1;const r={...t,date:parseInt(t.date,10)};try{if(e){const t=(0,T.H9)(this.db,"calendar",e);return await(0,T.BN)(t,r),!0}{const t=(0,T.H9)((0,T.rJ)(this.db,"calendar"));return await(0,T.BN)(t,r),!0}}catch(s){return console.error("Firestore 저장 중 오류 발생:",s),!1}}},mounted(){const t={apiKey:"AIzaSyDMjFwCNFE72bctk4BNodId8fLLXMQ_Ulw",authDomain:"hello-notification-121eb.firebaseapp.com",projectId:"hello-notification-121eb",storageBucket:"hello-notification-121eb.firebasestorage.app",messagingSenderId:"17313072285",appId:"1:17313072285:web:ddbd170a5b062f236fc074",measurementId:"G-8W89T2V4CF"},e=(0,x.Wp)(t);this.db=(0,T.aU)(e);const r=(0,T.rJ)(this.db,"calendar");this.unsubscribe=(0,T.aQ)((0,T.P)(r),t=>{this.dutyData=t.docs.map(t=>{const e=t.data();return{id:t.id,category:e.category,date:String(e.date),holidayYn:e.holidayYn,meYn:e.meYn,name:e.name}}),console.log("Firestore calendar data loaded successfully.",this.dutyData.length,"items.")},t=>{console.error("Error fetching Firestore data:",t)});const s=(0,P.dG)(e);(0,P.xD)(s,t=>{console.log("Message received: ",t)}),(0,P.gf)(s,{vapidKey:"BLYnDWIi8AbuQdrJx1ct6EU5hi6yz6dyG4GxFgLvb_2G42mMjdLwF9i_PkcN8csNR3HynhqVu9ZO92_Am_RcuVg"}).then(t=>{t?console.log("Firebase Token:",t):console.log("No registration token available. Request permission to generate one.")}).catch(t=>{console.log("An error occurred while retrieving token: ",t)})},beforeUnmount(){this.unsubscribe&&this.unsubscribe()}};const A=(0,F.A)(_,[["render",n]]);var S=A,U=r(4458);(0,U.k)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},offline(){console.log("No internet connection found. App is running in offline mode.")},updated(t){console.log("New content is available; please refresh."),document.dispatchEvent(new CustomEvent("swUpdated",{detail:t}))},error(t){console.error("Error during service worker registration:",t)}}),(0,s.Ef)(S).mount("#app")}},e={};function r(s){var o=e[s];if(void 0!==o)return o.exports;var a=e[s]={exports:{}};return t[s].call(a.exports,a,a.exports,r),a.exports}r.m=t,function(){var t=[];r.O=function(e,s,o,a){if(!s){var n=1/0;for(l=0;l<t.length;l++){s=t[l][0],o=t[l][1],a=t[l][2];for(var i=!0,d=0;d<s.length;d++)(!1&a||n>=a)&&Object.keys(r.O).every(function(t){return r.O[t](s[d])})?s.splice(d--,1):(i=!1,a<n&&(n=a));if(i){t.splice(l--,1);var c=o();void 0!==c&&(e=c)}}return e}a=a||0;for(var l=t.length;l>0&&t[l-1][2]>a;l--)t[l]=t[l-1];t[l]=[s,o,a]}}(),function(){r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,{a:e}),e}}(),function(){r.d=function(t,e){for(var s in e)r.o(e,s)&&!r.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};r.O.j=function(e){return 0===t[e]};var e=function(e,s){var o,a,n=s[0],i=s[1],d=s[2],c=0;if(n.some(function(e){return 0!==t[e]})){for(o in i)r.o(i,o)&&(r.m[o]=i[o]);if(d)var l=d(r)}for(e&&e(s);c<n.length;c++)a=n[c],r.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return r.O(l)},s=self["webpackChunkocc"]=self["webpackChunkocc"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=r.O(void 0,[504],function(){return r(3244)});s=r.O(s)})();
//# sourceMappingURL=app.9dae17ec.js.map