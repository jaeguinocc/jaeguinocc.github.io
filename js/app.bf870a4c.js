(function(){"use strict";var t={3016:function(t,e,r){var a=r(5130),s=r(6768);const o={id:"app"};function n(t,e,r,a,n,i){const d=(0,s.g2)("HW");return(0,s.uX)(),(0,s.CE)("div",o,[(0,s.bF)(d,{"duty-data":n.dutyData,"save-duty-entry":i.saveDutyEntry,"check-password":i.checkPassword},null,8,["duty-data","save-duty-entry","check-password"])])}r(8111),r(1701);var i=r(4232);const d={class:"calendar-container"},l={class:"fixed-header"},c={class:"header-top"},u={class:"month-title"},h={class:"header-bottom"},y={class:"weekdays"},p={class:"days"},m=["onClick"],f={key:0,class:"duty-name"},g={class:"nav-buttons-container"},w={key:0,class:"update-notification"},v={key:1,class:"modal-overlay"},k={class:"modal-content"},D={class:"modal-buttons"},b={key:0,class:"error-message"},E={key:2,class:"edit-form-container"},M={class:"form-grid"},L={class:"form-buttons"};function I(t,e,r,o,n,I){return(0,s.uX)(),(0,s.CE)("div",d,[(0,s.Lk)("div",l,[(0,s.Lk)("div",c,[(0,s.Lk)("h1",u,(0,i.v_)(I.currentMonthTitle),1),(0,s.Lk)("div",h,[e[15]||(e[15]=(0,s.Lk)("label",{for:"startDay"},"시작 요일:",-1)),(0,s.bo)((0,s.Lk)("select",{id:"startDay","onUpdate:modelValue":e[0]||(e[0]=t=>n.startDayIndex=t)},[...e[14]||(e[14]=[(0,s.Lk)("option",{value:"0"},"일요일",-1),(0,s.Lk)("option",{value:"1"},"월요일",-1)])],512),[[a.u1,n.startDayIndex]])])])]),(0,s.Lk)("div",y,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(I.reorderedWeekdays,t=>((0,s.uX)(),(0,s.CE)("span",{key:t,class:(0,i.C4)({sunday:"일"===t,saturday:"토"===t})},(0,i.v_)(t),3))),128))]),(0,s.Lk)("div",p,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(I.daysInCurrentMonth,t=>((0,s.uX)(),(0,s.CE)("span",{key:t.key,class:(0,i.C4)({day:!0,padded:t.padded,today:t.isToday,"my-duty":I.getDutyName(t.dateKey)&&I.getDutyName(t.dateKey).isMe}),onClick:e=>I.handleDayClick(t)},[(0,s.eW)((0,i.v_)(t.number)+" ",1),I.getDutyName(t.dateKey)?((0,s.uX)(),(0,s.CE)("div",f,(0,i.v_)(I.getDutyName(t.dateKey).name),1)):(0,s.Q3)("",!0)],10,m))),128))]),(0,s.Lk)("div",g,[(0,s.Lk)("button",{onClick:e[1]||(e[1]=(...t)=>I.prevMonth&&I.prevMonth(...t)),class:"nav-button prev-button"},"‹"),(0,s.Lk)("button",{onClick:e[2]||(e[2]=(...t)=>I.nextMonth&&I.nextMonth(...t)),class:"nav-button next-button"},"›")]),n.updateExists?((0,s.uX)(),(0,s.CE)("div",w,[e[16]||(e[16]=(0,s.Lk)("p",null,"새로운 버전 발견! 업데이트하시겠습니까?",-1)),(0,s.Lk)("button",{onClick:e[3]||(e[3]=(...t)=>I.refreshApp&&I.refreshApp(...t))},"업데이트")])):(0,s.Q3)("",!0),n.showPasswordModal?((0,s.uX)(),(0,s.CE)("div",v,[(0,s.Lk)("div",k,[e[17]||(e[17]=(0,s.Lk)("h3",null,"비밀번호 확인",-1)),e[18]||(e[18]=(0,s.Lk)("p",null,"당직 정보를 수정/입력하려면 비밀번호를 입력하세요.",-1)),(0,s.bo)((0,s.Lk)("input",{type:"password","onUpdate:modelValue":e[4]||(e[4]=t=>n.passwordInput=t),onKeyup:e[5]||(e[5]=(0,a.jR)((...t)=>I.validatePassword&&I.validatePassword(...t),["enter"])),placeholder:"비밀번호",autofocus:""},null,544),[[a.Jo,n.passwordInput]]),(0,s.Lk)("div",D,[(0,s.Lk)("button",{onClick:e[6]||(e[6]=(...t)=>I.validatePassword&&I.validatePassword(...t)),class:"modal-confirm"},"확인"),(0,s.Lk)("button",{onClick:e[7]||(e[7]=(...t)=>I.cancelPassword&&I.cancelPassword(...t)),class:"modal-cancel"},"취소")]),n.passwordMessage?((0,s.uX)(),(0,s.CE)("p",b,(0,i.v_)(n.passwordMessage),1)):(0,s.Q3)("",!0)])])):(0,s.Q3)("",!0),n.showEditForm?((0,s.uX)(),(0,s.CE)("div",E,[(0,s.Lk)("h2",null,(0,i.v_)(n.formDocId?"당직 정보 수정":"새 당직 정보 입력")+" ("+(0,i.v_)(n.currentEditingDate)+")",1),(0,s.Lk)("div",M,[e[21]||(e[21]=(0,s.Lk)("label",{for:"category"},"Category:",-1)),(0,s.bo)((0,s.Lk)("input",{id:"category",type:"text","onUpdate:modelValue":e[8]||(e[8]=t=>n.formEntry.category=t)},null,512),[[a.Jo,n.formEntry.category]]),e[22]||(e[22]=(0,s.Lk)("label",{for:"holidayYn"},"Holiday (Y/N):",-1)),(0,s.bo)((0,s.Lk)("select",{id:"holidayYn","onUpdate:modelValue":e[9]||(e[9]=t=>n.formEntry.holidayYn=t)},[...e[19]||(e[19]=[(0,s.Lk)("option",{value:"Y"},"Y",-1),(0,s.Lk)("option",{value:"N"},"N",-1)])],512),[[a.u1,n.formEntry.holidayYn]]),e[23]||(e[23]=(0,s.Lk)("label",{for:"meYn"},"Me (Y/N):",-1)),(0,s.bo)((0,s.Lk)("select",{id:"meYn","onUpdate:modelValue":e[10]||(e[10]=t=>n.formEntry.meYn=t)},[...e[20]||(e[20]=[(0,s.Lk)("option",{value:"Y"},"Y",-1),(0,s.Lk)("option",{value:"N"},"N",-1)])],512),[[a.u1,n.formEntry.meYn]]),e[24]||(e[24]=(0,s.Lk)("label",{for:"name"},"Name:",-1)),(0,s.bo)((0,s.Lk)("input",{id:"name",type:"text","onUpdate:modelValue":e[11]||(e[11]=t=>n.formEntry.name=t)},null,512),[[a.Jo,n.formEntry.name]]),(0,s.Lk)("div",L,[(0,s.Lk)("button",{onClick:e[12]||(e[12]=(...t)=>I.saveDuty&&I.saveDuty(...t)),class:"save-button"},"저장"),(0,s.Lk)("button",{onClick:e[13]||(e[13]=(...t)=>I.closeForm&&I.closeForm(...t)),class:"cancel-button"},"취소")])]),n.formMessage?((0,s.uX)(),(0,s.CE)("p",{key:0,class:(0,i.C4)({"error-message":n.formError,"success-message":!n.formError})},(0,i.v_)(n.formMessage),3)):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0)])}r(4114),r(2489),r(116);var F={name:"HelloWorld",props:{dutyData:{type:Array,default:()=>[]},saveDutyEntry:{type:Function,required:!0},checkPassword:{type:Function,required:!0}},data(){return{weekdays:["일","월","화","수","목","금","토"],currentDate:new Date,startDayIndex:parseInt(localStorage.getItem("startDayIndex"))||0,updateExists:!1,registration:null,lastTaps:[],editingDay:null,currentEditingDate:"",formDocId:null,showPasswordModal:!1,passwordInput:"",passwordMessage:"",showEditForm:!1,formEntry:{category:"당직",date:"",holidayYn:"N",meYn:"N",name:""},formMessage:"",formError:!1}},computed:{currentMonthTitle(){const t=this.currentDate.getFullYear(),e=this.currentDate.getMonth();return`${t}년 ${e+1}월`},reorderedWeekdays(){const t=[...this.weekdays];for(let e=0;e<this.startDayIndex;e++)t.push(t.shift());return t},daysInCurrentMonth(){const t=this.currentDate.getFullYear(),e=this.currentDate.getMonth(),r=new Date,a=[],s=new Date(t,e,1).getDay(),o=(s-this.startDayIndex+7)%7,n=new Date(t,e,0),i=n.getDate(),d=n.getFullYear(),l=n.getMonth()+1;for(let f=0;f<o;f++){const t=i-o+1+f,e=this.formatDate(d,l,t);a.push({key:`prev-${e}`,number:t,padded:!0,isToday:!1,dateKey:e})}const c=new Date(t,e+1,0).getDate(),u=e+1;for(let f=1;f<=c;f++){const s=new Date(t,e,f),o=s.toDateString()===r.toDateString(),n=this.formatDate(t,u,f);a.push({key:`current-${n}`,number:f,padded:!1,isToday:o,dateKey:n})}const h=new Date(t,e+1,1),y=h.getFullYear(),p=h.getMonth()+1;let m=1;while(a.length<42&&a.length%7!==0){const t=this.formatDate(y,p,m);a.push({key:`next-${t}`,number:m,padded:!0,isToday:!1,dateKey:t}),m++}return a}},watch:{startDayIndex(t){localStorage.setItem("startDayIndex",t)}},created(){document.addEventListener("swUpdated",this.showUpdatePrompt,{once:!0})},methods:{formatDate(t,e,r){const a=String(t).slice(-2),s=String(e).padStart(2,"0"),o=String(r).padStart(2,"0");return`${a}${s}${o}`},getDutyName(t){if(!t||!this.dutyData)return null;const e=this.dutyData.find(e=>e.date===t&&"당직"===e.category);return e?{name:e.name,isMe:"Y"===e.meYn,docId:e.id,fullEntry:e}:null},handleDayClick(t){if(t.padded)return;const e=Date.now(),r=t.dateKey;this.lastTaps=this.lastTaps.filter(t=>e-t<500),this.lastTaps.push(e),3===this.lastTaps.length&&(this.editingDay=t.number,this.currentEditingDate=r,this.showPasswordModal=!0,this.passwordInput="",this.passwordMessage="",this.lastTaps=[])},async validatePassword(){this.passwordMessage="확인 중...";const t=await this.checkPassword(this.passwordInput);t.success?(this.passwordMessage="",this.showPasswordModal=!1,this.openEditForm()):this.passwordMessage=t.message||"비밀번호가 올바르지 않습니다."},cancelPassword(){this.showPasswordModal=!1,this.passwordInput="",this.passwordMessage=""},openEditForm(){const t=this.getDutyName(this.currentEditingDate);if(this.formEntry.date=this.currentEditingDate,this.formMessage="",this.formError=!1,t&&t.fullEntry){const e=t.fullEntry;this.formDocId=e.id,this.formEntry.category=e.category,this.formEntry.holidayYn=e.holidayYn,this.formEntry.meYn=e.meYn,this.formEntry.name=e.name}else this.formDocId=null,this.formEntry.category="당직",this.formEntry.holidayYn="N",this.formEntry.meYn="N",this.formEntry.name="";this.showEditForm=!0},async saveDuty(){this.formMessage="저장 중...",this.formError=!1;const t=await this.saveDutyEntry(this.formEntry,this.formDocId);t?(this.formMessage=this.formDocId?"성공적으로 수정되었습니다.":"성공적으로 생성되었습니다.",setTimeout(this.closeForm,400)):(this.formMessage="저장에 실패했습니다. 콘솔을 확인하세요.",this.formError=!0)},closeForm(){this.showEditForm=!1,this.editingDay=null,this.currentEditingDate="",this.formDocId=null,this.formMessage="",this.formError=!1,this.formEntry={category:"당직",date:"",holidayYn:"N",meYn:"N",name:""}},prevMonth(){this.currentDate=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth()-1,1),this.closeForm()},nextMonth(){this.currentDate=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth()+1,1),this.closeForm()},showUpdatePrompt(t){this.registration=t.detail,this.updateExists=!0},refreshApp(){this.updateExists=!1,this.registration&&this.registration.waiting&&this.registration.waiting.postMessage({type:"SKIP_WAITING"}),window.location.reload()}}},Y=r(1241);const C=(0,Y.A)(F,[["render",I],["__scopeId","data-v-0a9a4d66"]]);var N=C,x=r(6400),P=r(4703),S=r(2832),_={name:"App",components:{HW:N},data(){return{db:null,dutyData:[],unsubscribe:null}},methods:{async checkPassword(t){if(!this.db)return console.error("Firestore DB is not initialized."),{success:!1,message:"DB 초기화 오류."};try{const e=(0,S.P)((0,S.rJ)(this.db,"editpw"),(0,S._M)("password","==",t)),r=await(0,S.GG)(e);return r.empty?{success:!1,message:"비밀번호가 일치하지 않습니다."}:{success:!0}}catch(e){return console.error("비밀번호 확인 중 오류 발생:",e),{success:!1,message:`비밀번호 확인 중 오류 발생: ${e.message}`}}},async saveDutyEntry(t,e){if(!this.db)return console.error("Firestore DB is not initialized."),!1;const r={...t,date:parseInt(t.date,10)};try{if(e){const t=(0,S.H9)(this.db,"calendar",e);return await(0,S.BN)(t,r),!0}{const t=(0,S.H9)((0,S.rJ)(this.db,"calendar"));return await(0,S.BN)(t,r),!0}}catch(a){return console.error("Firestore 저장 중 오류 발생:",a),!1}}},mounted(){const t={apiKey:"AIzaSyDMjFwCNFE72bctk4BNodId8fLLXMQ_Ulw",authDomain:"hello-notification-121eb.firebaseapp.com",projectId:"hello-notification-121eb",storageBucket:"hello-notification-121eb.firebasestorage.app",messagingSenderId:"17313072285",appId:"1:17313072285:web:ddbd170a5b062f236fc074",measurementId:"G-8W89T2V4CF"},e=(0,x.Wp)(t);this.db=(0,S.aU)(e);const r=(0,S.rJ)(this.db,"calendar"),a=new Date,s=new Date(a.getFullYear(),a.getMonth()-1,1),o=parseInt(String(s.getFullYear()).slice(-2)+String(s.getMonth()+1).padStart(2,"0")+"01"),n=new Date(a.getFullYear(),a.getMonth()+2,0),i=parseInt(String(n.getFullYear()).slice(-2)+String(n.getMonth()+1).padStart(2,"0")+String(n.getDate()).padStart(2,"0")),d=(0,S.P)(r,(0,S._M)("date",">=",o),(0,S._M)("date","<=",i));this.unsubscribe=(0,S.aQ)(d,t=>{this.dutyData=t.docs.map(t=>{const e=t.data();return{id:t.id,category:e.category,date:String(e.date),holidayYn:e.holidayYn,meYn:e.meYn,name:e.name}}),console.log("Firestore calendar data loaded successfully.",this.dutyData.length,"items.")},t=>{console.error("Error fetching Firestore data:",t)});const l=(0,P.dG)(e);(0,P.xD)(l,t=>{console.log("Message received: ",t)}),(0,P.gf)(l,{vapidKey:"BLYnDWIi8AbuQdrJx1ct6EU5hi6yz6dyG4GxFgLvb_2G42mMjdLwF9i_PkcN8csNR3HynhqVu9ZO92_Am_RcuVg"}).then(t=>{t?console.log("Firebase Token:",t):console.log("No registration token available. Request permission to generate one.")}).catch(t=>{console.log("An error occurred while retrieving token: ",t)})},beforeUnmount(){this.unsubscribe&&this.unsubscribe()}};const T=(0,Y.A)(_,[["render",n]]);var A=T,K=r(4458);(0,K.k)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},offline(){console.log("No internet connection found. App is running in offline mode.")},updated(t){console.log("New content is available; please refresh."),document.dispatchEvent(new CustomEvent("swUpdated",{detail:t}))},error(t){console.error("Error during service worker registration:",t)}}),(0,a.Ef)(A).mount("#app")}},e={};function r(a){var s=e[a];if(void 0!==s)return s.exports;var o=e[a]={exports:{}};return t[a].call(o.exports,o,o.exports,r),o.exports}r.m=t,function(){var t=[];r.O=function(e,a,s,o){if(!a){var n=1/0;for(c=0;c<t.length;c++){a=t[c][0],s=t[c][1],o=t[c][2];for(var i=!0,d=0;d<a.length;d++)(!1&o||n>=o)&&Object.keys(r.O).every(function(t){return r.O[t](a[d])})?a.splice(d--,1):(i=!1,o<n&&(n=o));if(i){t.splice(c--,1);var l=s();void 0!==l&&(e=l)}}return e}o=o||0;for(var c=t.length;c>0&&t[c-1][2]>o;c--)t[c]=t[c-1];t[c]=[a,s,o]}}(),function(){r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,{a:e}),e}}(),function(){r.d=function(t,e){for(var a in e)r.o(e,a)&&!r.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};r.O.j=function(e){return 0===t[e]};var e=function(e,a){var s,o,n=a[0],i=a[1],d=a[2],l=0;if(n.some(function(e){return 0!==t[e]})){for(s in i)r.o(i,s)&&(r.m[s]=i[s]);if(d)var c=d(r)}for(e&&e(a);l<n.length;l++)o=n[l],r.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return r.O(c)},a=self["webpackChunkocc"]=self["webpackChunkocc"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=r.O(void 0,[504],function(){return r(3016)});a=r.O(a)})();
//# sourceMappingURL=app.bf870a4c.js.map