(function(){"use strict";var t={2098:function(t,e,s){var a=s(5130),n=s(6768);const o={id:"app"};function r(t,e,s,a,r,i){const d=(0,n.g2)("HW");return(0,n.uX)(),(0,n.CE)("div",o,[(0,n.bF)(d,{"duty-data":r.dutyData,"save-duty-entry":i.saveDutyEntry,"check-password":i.checkPassword},null,8,["duty-data","save-duty-entry","check-password"])])}s(4114),s(8111),s(116),s(7588),s(1701);var i=s(4232);const d={class:"calendar-container"},c={class:"fixed-header"},l={class:"header-top"},u={class:"month-title"},h={class:"header-bottom"},y={class:"weekdays"},m={class:"days"},p=["onClick"],f={key:0,class:"duty-name"},g={class:"nav-buttons-container"},w={key:0,class:"update-notification"},k={key:1,class:"modal-overlay"},v={class:"modal-content"},b={class:"modal-buttons"},D={key:0,class:"error-message"},E={key:2,class:"edit-form-container"},M={class:"form-grid"},L={class:"form-buttons"};function I(t,e,s,o,r,I){return(0,n.uX)(),(0,n.CE)("div",d,[(0,n.Lk)("div",c,[(0,n.Lk)("div",l,[(0,n.Lk)("h1",u,(0,i.v_)(I.currentMonthTitle),1),(0,n.Lk)("div",h,[e[15]||(e[15]=(0,n.Lk)("label",{for:"startDay"},"ÏãúÏûë ÏöîÏùº:",-1)),(0,n.bo)((0,n.Lk)("select",{id:"startDay","onUpdate:modelValue":e[0]||(e[0]=t=>r.startDayIndex=t)},[...e[14]||(e[14]=[(0,n.Lk)("option",{value:"0"},"ÏùºÏöîÏùº",-1),(0,n.Lk)("option",{value:"1"},"ÏõîÏöîÏùº",-1)])],512),[[a.u1,r.startDayIndex]])])])]),(0,n.Lk)("div",y,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(I.reorderedWeekdays,t=>((0,n.uX)(),(0,n.CE)("span",{key:t,class:(0,i.C4)({sunday:"Ïùº"===t,saturday:"ÌÜ†"===t})},(0,i.v_)(t),3))),128))]),(0,n.Lk)("div",m,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(I.daysInCurrentMonth,t=>((0,n.uX)(),(0,n.CE)("span",{key:t.key,class:(0,i.C4)({day:!0,padded:t.padded,today:t.isToday,"my-duty":I.getDutyName(t.dateKey)&&I.getDutyName(t.dateKey).isMe}),onClick:e=>I.handleDayClick(t)},[(0,n.eW)((0,i.v_)(t.number)+" ",1),I.getDutyName(t.dateKey)?((0,n.uX)(),(0,n.CE)("div",f,(0,i.v_)(I.getDutyName(t.dateKey).name),1)):(0,n.Q3)("",!0)],10,p))),128))]),(0,n.Lk)("div",g,[(0,n.Lk)("button",{onClick:e[1]||(e[1]=(...t)=>I.prevMonth&&I.prevMonth(...t)),class:"nav-button prev-button"},"‚Äπ"),(0,n.Lk)("button",{onClick:e[2]||(e[2]=(...t)=>I.nextMonth&&I.nextMonth(...t)),class:"nav-button next-button"},"‚Ä∫")]),r.updateExists?((0,n.uX)(),(0,n.CE)("div",w,[e[16]||(e[16]=(0,n.Lk)("p",null,"ÏÉàÎ°úÏö¥ Î≤ÑÏ†Ñ Î∞úÍ≤¨! ÏóÖÎç∞Ïù¥Ìä∏ÌïòÏãúÍ≤†ÏäµÎãàÍπå?",-1)),(0,n.Lk)("button",{onClick:e[3]||(e[3]=(...t)=>I.refreshApp&&I.refreshApp(...t))},"ÏóÖÎç∞Ïù¥Ìä∏")])):(0,n.Q3)("",!0),r.showPasswordModal?((0,n.uX)(),(0,n.CE)("div",k,[(0,n.Lk)("div",v,[e[17]||(e[17]=(0,n.Lk)("h3",null,"ÎπÑÎ∞ÄÎ≤àÌò∏ ÌôïÏù∏",-1)),e[18]||(e[18]=(0,n.Lk)("p",null,"ÎãπÏßÅ Ï†ïÎ≥¥Î•º ÏàòÏ†ï/ÏûÖÎ†•ÌïòÎ†§Î©¥ ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî.",-1)),(0,n.bo)((0,n.Lk)("input",{type:"password","onUpdate:modelValue":e[4]||(e[4]=t=>r.passwordInput=t),onKeyup:e[5]||(e[5]=(0,a.jR)((...t)=>I.validatePassword&&I.validatePassword(...t),["enter"])),placeholder:"ÎπÑÎ∞ÄÎ≤àÌò∏",autofocus:""},null,544),[[a.Jo,r.passwordInput]]),(0,n.Lk)("div",b,[(0,n.Lk)("button",{onClick:e[6]||(e[6]=(...t)=>I.validatePassword&&I.validatePassword(...t)),class:"modal-confirm"},"ÌôïÏù∏"),(0,n.Lk)("button",{onClick:e[7]||(e[7]=(...t)=>I.cancelPassword&&I.cancelPassword(...t)),class:"modal-cancel"},"Ï∑®ÏÜå")]),r.passwordMessage?((0,n.uX)(),(0,n.CE)("p",D,(0,i.v_)(r.passwordMessage),1)):(0,n.Q3)("",!0)])])):(0,n.Q3)("",!0),r.showEditForm?((0,n.uX)(),(0,n.CE)("div",E,[(0,n.Lk)("h2",null,(0,i.v_)(r.formDocId?"ÎãπÏßÅ Ï†ïÎ≥¥ ÏàòÏ†ï":"ÏÉà ÎãπÏßÅ Ï†ïÎ≥¥ ÏûÖÎ†•")+" ("+(0,i.v_)(r.currentEditingDate)+")",1),(0,n.Lk)("div",M,[e[21]||(e[21]=(0,n.Lk)("label",{for:"category"},"Category:",-1)),(0,n.bo)((0,n.Lk)("input",{id:"category",type:"text","onUpdate:modelValue":e[8]||(e[8]=t=>r.formEntry.category=t)},null,512),[[a.Jo,r.formEntry.category]]),e[22]||(e[22]=(0,n.Lk)("label",{for:"holidayYn"},"Holiday (Y/N):",-1)),(0,n.bo)((0,n.Lk)("select",{id:"holidayYn","onUpdate:modelValue":e[9]||(e[9]=t=>r.formEntry.holidayYn=t)},[...e[19]||(e[19]=[(0,n.Lk)("option",{value:"Y"},"Y",-1),(0,n.Lk)("option",{value:"N"},"N",-1)])],512),[[a.u1,r.formEntry.holidayYn]]),e[23]||(e[23]=(0,n.Lk)("label",{for:"meYn"},"Me (Y/N):",-1)),(0,n.bo)((0,n.Lk)("select",{id:"meYn","onUpdate:modelValue":e[10]||(e[10]=t=>r.formEntry.meYn=t)},[...e[20]||(e[20]=[(0,n.Lk)("option",{value:"Y"},"Y",-1),(0,n.Lk)("option",{value:"N"},"N",-1)])],512),[[a.u1,r.formEntry.meYn]]),e[24]||(e[24]=(0,n.Lk)("label",{for:"name"},"Name:",-1)),(0,n.bo)((0,n.Lk)("input",{id:"name",type:"text","onUpdate:modelValue":e[11]||(e[11]=t=>r.formEntry.name=t)},null,512),[[a.Jo,r.formEntry.name]]),(0,n.Lk)("div",L,[(0,n.Lk)("button",{onClick:e[12]||(e[12]=(...t)=>I.saveDuty&&I.saveDuty(...t)),class:"save-button"},"Ï†ÄÏû•"),(0,n.Lk)("button",{onClick:e[13]||(e[13]=(...t)=>I.closeForm&&I.closeForm(...t)),class:"cancel-button"},"Ï∑®ÏÜå")])]),r.formMessage?((0,n.uX)(),(0,n.CE)("p",{key:0,class:(0,i.C4)({"error-message":r.formError,"success-message":!r.formError})},(0,i.v_)(r.formMessage),3)):(0,n.Q3)("",!0)])):(0,n.Q3)("",!0)])}s(2489);var C={name:"HelloWorld",props:{dutyData:{type:Array,default:()=>[]},saveDutyEntry:{type:Function,required:!0},checkPassword:{type:Function,required:!0}},data(){return{weekdays:["Ïùº","Ïõî","Ìôî","Ïàò","Î™©","Í∏à","ÌÜ†"],currentDate:new Date,startDayIndex:parseInt(localStorage.getItem("startDayIndex"))||0,updateExists:!1,registration:null,lastTaps:[],editingDay:null,currentEditingDate:"",formDocId:null,showPasswordModal:!1,passwordInput:"",passwordMessage:"",showEditForm:!1,formEntry:{category:"ÎãπÏßÅ",date:"",holidayYn:"N",meYn:"N",name:""},formMessage:"",formError:!1}},computed:{currentMonthTitle(){const t=this.currentDate.getFullYear(),e=this.currentDate.getMonth();return`${t}ÎÖÑ ${e+1}Ïõî`},reorderedWeekdays(){const t=[...this.weekdays];for(let e=0;e<this.startDayIndex;e++)t.push(t.shift());return t},daysInCurrentMonth(){const t=this.currentDate.getFullYear(),e=this.currentDate.getMonth(),s=new Date,a=[],n=new Date(t,e,1).getDay(),o=(n-this.startDayIndex+7)%7,r=new Date(t,e,0),i=r.getDate(),d=r.getFullYear(),c=r.getMonth()+1;for(let f=0;f<o;f++){const t=i-o+1+f,e=this.formatDate(d,c,t);a.push({key:`prev-${e}`,number:t,padded:!0,isToday:!1,dateKey:e})}const l=new Date(t,e+1,0).getDate(),u=e+1;for(let f=1;f<=l;f++){const n=new Date(t,e,f),o=n.toDateString()===s.toDateString(),r=this.formatDate(t,u,f);a.push({key:`current-${r}`,number:f,padded:!1,isToday:o,dateKey:r})}const h=new Date(t,e+1,1),y=h.getFullYear(),m=h.getMonth()+1;let p=1;while(a.length<42&&a.length%7!==0){const t=this.formatDate(y,m,p);a.push({key:`next-${t}`,number:p,padded:!0,isToday:!1,dateKey:t}),p++}return a}},watch:{startDayIndex(t){localStorage.setItem("startDayIndex",t)}},created(){document.addEventListener("swUpdated",this.showUpdatePrompt,{once:!0})},methods:{async saveDuty(){this.formMessage="Ï†ÄÏû• Ï§ë...",this.formError=!1;const t=await this.saveDutyEntry(this.formEntry,this.formDocId);t?(this.formMessage="ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.",setTimeout(()=>{this.closeForm()},500)):(this.formMessage="Ï†ÄÏû•Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.",this.formError=!0)},formatDate(t,e,s){const a=String(t).slice(-2),n=String(e).padStart(2,"0"),o=String(s).padStart(2,"0");return`${a}${n}${o}`},getDutyName(t){if(!t||!this.dutyData)return null;const e=this.dutyData.find(e=>e.date===t&&"ÎãπÏßÅ"===e.category);return e?{name:e.name,isMe:"Y"===e.meYn,docId:e.id,fullEntry:e}:null},handleDayClick(t){if(t.padded)return;const e=Date.now(),s=t.dateKey;this.lastTaps=this.lastTaps.filter(t=>e-t<500),this.lastTaps.push(e),3===this.lastTaps.length&&(this.editingDay=t.number,this.currentEditingDate=s,this.showPasswordModal=!0,this.passwordInput="",this.passwordMessage="",this.lastTaps=[])},async validatePassword(){this.passwordMessage="ÌôïÏù∏ Ï§ë...";const t=await this.checkPassword(this.passwordInput);t.success?(this.passwordMessage="",this.showPasswordModal=!1,this.openEditForm()):this.passwordMessage=t.message||"ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏäµÎãàÎã§."},cancelPassword(){this.showPasswordModal=!1,this.passwordInput="",this.passwordMessage=""},openEditForm(){const t=this.getDutyName(this.currentEditingDate);if(this.formEntry.date=this.currentEditingDate,this.formMessage="",this.formError=!1,t&&t.fullEntry){const e=t.fullEntry;this.formDocId=e.id,this.formEntry.category=e.category,this.formEntry.holidayYn=e.holidayYn,this.formEntry.meYn=e.meYn,this.formEntry.name=e.name}else this.formDocId=null,this.formEntry.category="ÎãπÏßÅ",this.formEntry.holidayYn="N",this.formEntry.meYn="N",this.formEntry.name="";this.showEditForm=!0},closeForm(){this.showEditForm=!1,this.editingDay=null,this.currentEditingDate="",this.formDocId=null,this.formMessage="",this.formError=!1,this.formEntry={category:"ÎãπÏßÅ",date:"",holidayYn:"N",meYn:"N",name:""}},prevMonth(){this.currentDate=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth()-1,1),this.closeForm()},nextMonth(){this.currentDate=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth()+1,1),this.closeForm()},showUpdatePrompt(t){this.registration=t.detail,this.updateExists=!0},refreshApp(){this.updateExists=!1,this.registration&&this.registration.waiting&&this.registration.waiting.postMessage({type:"SKIP_WAITING"}),window.location.reload()}}},F=s(1241);const Y=(0,F.A)(C,[["render",I],["__scopeId","data-v-e4ed6724"]]);var N=Y,x=s(6400),P=s(4703),_=s(2832),T={name:"App",components:{HW:N},data(){return{db:null,dutyData:[],unsubscribe:null}},methods:{async sendAutoNotification(t,e,s){try{const a=await(0,_.GG)((0,_.rJ)(this.db,"fcm_tokens")),n=[];if(a.forEach(t=>n.push(t.data().token)),0===n.length)return;const o=String(e),r=`20${o.substring(0,2)}ÎÖÑ ${o.substring(2,4)}Ïõî ${o.substring(4,6)}Ïùº`,i="ÏóÜÏùå"!==s&&s!==t?`[${r}] ÎãπÏßÅÏûêÍ∞Ä ${s}Îãò ‚Üí ${t}ÎãòÏúºÎ°ú Î≥ÄÍ≤ΩÎêòÏóàÏäµÎãàÎã§.`:`[${r}] ${t}ÎãòÏù¥ ÎãπÏßÅÏúºÎ°ú Îì±Î°ùÎêòÏóàÏäµÎãàÎã§.`,d=(0,_.getFunctions)(),c=(0,_.httpsCallable)(d,"sendFcmNotification"),l=await c({tokens:n,title:"üìÖ ÎãπÏßÅ ÏóÖÎç∞Ïù¥Ìä∏ ÏïåÎ¶º",body:i});console.log("ÏïåÎ¶º ÏÑúÎ≤Ñ ÏùëÎãµ:",l.data)}catch(a){console.error("ÏïåÎ¶º ÏöîÏ≤≠ Ï§ë Ïò§Î•ò:",a)}},async saveDutyEntry(t,e){if(!this.db)return!1;const s={...t,date:parseInt(t.date,10)};try{let t,a="ÏóÜÏùå";if(e){const t=this.dutyData.find(t=>t.id===e);t&&(a=t.name)}return t=e?(0,_.H9)(this.db,"calendar",e):(0,_.H9)((0,_.rJ)(this.db,"calendar")),await(0,_.BN)(t,s),this.sendAutoNotification(s.name,s.date,a),!0}catch(a){return console.error("Ï†ÄÏû• ÏóêÎü¨:",a),!1}},async checkPassword(t){if(!this.db)return console.error("Firestore DB is not initialized."),{success:!1,message:"DB Ï¥àÍ∏∞Ìôî Ïò§Î•ò."};try{const e=(0,_.P)((0,_.rJ)(this.db,"editpw"),(0,_._M)("password","==",t)),s=await(0,_.GG)(e);return s.empty?{success:!1,message:"ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä ÏùºÏπòÌïòÏßÄ ÏïäÏäµÎãàÎã§."}:{success:!0}}catch(e){return console.error("ÎπÑÎ∞ÄÎ≤àÌò∏ ÌôïÏù∏ Ï§ë Ïò§Î•ò Î∞úÏÉù:",e),{success:!1,message:`ÎπÑÎ∞ÄÎ≤àÌò∏ ÌôïÏù∏ Ï§ë Ïò§Î•ò Î∞úÏÉù: ${e.message}`}}}},mounted(){const t={apiKey:"AIzaSyDMjFwCNFE72bctk4BNodId8fLLXMQ_Ulw",authDomain:"hello-notification-121eb.firebaseapp.com",projectId:"hello-notification-121eb",storageBucket:"hello-notification-121eb.firebasestorage.app",messagingSenderId:"17313072285",appId:"1:17313072285:web:ddbd170a5b062f236fc074",measurementId:"G-8W89T2V4CF"},e=(0,x.Wp)(t);this.db=(0,_.aU)(e);const s=(0,P.dG)(e),a=(0,_.P)((0,_.rJ)(this.db,"calendar"),(0,_._M)("date",">=",260101),(0,_._M)("date","<=",261231));this.unsubscribe=(0,_.aQ)(a,t=>{this.dutyData=t.docs.map(t=>({id:t.id,...t.data(),date:String(t.data().date)}))}),(0,P.gf)(s,{vapidKey:"BLYnDWIi8AbuQdrJx1ct6EU5hi6yz6dyG4GxFgLvb_2G42mMjdLwF9i_PkcN8csNR3HynhqVu9ZO92_Am_RcuVg"}).then(async t=>{t&&(await(0,_.BN)((0,_.H9)(this.db,"fcm_tokens",t),{token:t,lastUpdated:new Date},{merge:!0}),console.log("FCM ÌÜ†ÌÅ∞ ÏûêÎèô Ï†ÄÏû• ÏôÑÎ£å"))}).catch(t=>{console.log("ÌÜ†ÌÅ∞ Í∞ÄÏ†∏Ïò§Í∏∞ Ïã§Ìå®:",t)}),(0,P.xD)(s,t=>{console.log("Î©îÏãúÏßÄ ÏàòÏã†:",t)})},beforeUnmount(){this.unsubscribe&&this.unsubscribe()}};const $=(0,F.A)(T,[["render",r]]);var A=$,S=s(4458);(0,S.k)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},offline(){console.log("No internet connection found. App is running in offline mode.")},updated(t){console.log("New content is available; please refresh."),document.dispatchEvent(new CustomEvent("swUpdated",{detail:t}))},error(t){console.error("Error during service worker registration:",t)}}),(0,a.Ef)(A).mount("#app")}},e={};function s(a){var n=e[a];if(void 0!==n)return n.exports;var o=e[a]={exports:{}};return t[a].call(o.exports,o,o.exports,s),o.exports}s.m=t,function(){var t=[];s.O=function(e,a,n,o){if(!a){var r=1/0;for(l=0;l<t.length;l++){a=t[l][0],n=t[l][1],o=t[l][2];for(var i=!0,d=0;d<a.length;d++)(!1&o||r>=o)&&Object.keys(s.O).every(function(t){return s.O[t](a[d])})?a.splice(d--,1):(i=!1,o<r&&(r=o));if(i){t.splice(l--,1);var c=n();void 0!==c&&(e=c)}}return e}o=o||0;for(var l=t.length;l>0&&t[l-1][2]>o;l--)t[l]=t[l-1];t[l]=[a,n,o]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var a in e)s.o(e,a)&&!s.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};s.O.j=function(e){return 0===t[e]};var e=function(e,a){var n,o,r=a[0],i=a[1],d=a[2],c=0;if(r.some(function(e){return 0!==t[e]})){for(n in i)s.o(i,n)&&(s.m[n]=i[n]);if(d)var l=d(s)}for(e&&e(a);c<r.length;c++)o=r[c],s.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return s.O(l)},a=self["webpackChunkocc"]=self["webpackChunkocc"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=s.O(void 0,[504],function(){return s(2098)});a=s.O(a)})();
//# sourceMappingURL=app.d18379e2.js.map